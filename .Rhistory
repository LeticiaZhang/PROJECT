# Check the independent variable
skewness(mydataset$RELIG_ENGAGEMENT)
library(haven)
library(dplyr)
library(ggplot2)
library(tidyr)
library(car)
library(moments)
library(boot)
load("C:/Users/User/Downloads/ICPSR_38964-V2/ICPSR_38964/DS0001/38964-0001-Data.rda")
dataset <- da38964.0001
rm(da38964.0001)
# Check the independent variable
skewness(mydataset$RELIG_ENGAGEMENT)
#Select variables related to my research question
my_dataset <- dataset %>% select(RELIG_ATTEND, RELIG_IMP, RACEREC, LONELY_A, LONELY_B, LONELY_C)
my_dataset <- drop_na(my_dataset)
summary(my_dataset)
#recode and composite the variables
my_dataset$RELIG_ATTEND <- 5 - as.numeric(my_dataset$RELIG_ATTEND)
my_dataset$RELIG_IMP <- 5 - as.numeric(my_dataset$RELIG_IMP)
my_dataset$RELIG_ENGAGEMENT <- (my_dataset$RELIG_ATTEND + my_dataset$RELIG_IMP) / 2
my_dataset$LONELY_A <- as.numeric(my_dataset$LONELY_A)
my_dataset$LONELY_B <- as.numeric(my_dataset$LONELY_B)
my_dataset$LONELY_C <- as.numeric(my_dataset$LONELY_C)
my_dataset$LONELY <- (my_dataset$LONELY_A + my_dataset$LONELY_B + my_dataset$LONELY_C) / 3
# Check the independent variable
skewness(mydataset$RELIG_ENGAGEMENT)
# Check the independent variable
skewness(mydataset$RELIG_ENGAGEMENT)
# Check the independent variable
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
ggplot(lab4data, aes(x = Performance)) + geom_histogram(binwidth = 20) + theme_classic()
library(car)
library(dplyr)
library(tidyr)
library(ggplot2)
library(psych)
library(bruceR)
lab4data <- read.csv("C:/Users/User/Downloads/Lab4-main/Lab4-main/skewed.csv")
ggplot(lab4data, aes(x = Performance)) + geom_histogram(binwidth = 20) + theme_classic()
ggplot(lab4data, aes(x = Performance)) + geom_density(adjust = 2)  + theme_classic()
qq<-ggplot(lab4data, aes(sample = Performance)) + geom_qq()  + theme_classic()
qq+ geom_qq_line()
#qq plot: normal if the dots fit to the line well
#functions below are base R functions, they can do the job, but not as customizable as ggplot
hist(lab4data$Performance)
qqnorm(lab4data$Performance, col = "steelblue", lwd = 2)
plot(density(lab4data$Performance, na.rm = TRUE, bw = 90),  lwd=2, main = "")
#a fun function to plot the violin plot by group, but it's not part of ggplot
violinBy(Performance ~ Group, data = lab4data, rain= TRUE, vertical = FALSE)
#Find a way to plot the histograms, density, and qq plots by groups using ggplot
ggplot(lab4data, aes(x = Performance)) + geom_histogram(binwidth = 20) + facet_wrap(~Group) + theme_classic()
ggplot(lab4data, aes(x = Performance)) + geom_density(adjust = 2) + facet_wrap(~Group) + theme_classic()
qq<-ggplot(lab4data, aes(sample = Performance)) + geom_qq() + facet_wrap(~Group) + theme_classic()
qq+ geom_qq_line()
#Use ggplot to create a violin plot by groups
ggplot(lab4data, aes(x = Performance, y = Group)) + geom_violin() + theme_classic()
# Check the independent variable
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT, y = RACEREC)) + geom_violin() + theme_bruce()
# Check the independent variable
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT, y = RACEREC)) + geom_violin() + theme_classic()
plot(density(my_dataset$RELIG_ENGAGEMENT, na.rm = TRUE, bw = 90),  lwd=2, main = "")
plot(density(my_dataset$LONELY, na.rm = TRUE, bw = 90),  lwd=2, main = "")
# Check the dependent variable
# Check skewness and kurtosis
skewness(my_dataset$LONELY)
kurtosis(my_dataset$LONELY)
# Density plot of loneliness
plot(density(my_dataset$LONELY, na.rm = TRUE, bw = 90),  lwd=2, main = "")
# Bootstrap the mean for a group to see the sampling distribution
boot_mean <- function(data, indices) {
d <- data[indices, ]  # Resample data with replacement
return(mean(d$LONELY))  # Calculate mean of the 'LONELY' variable
}
my_group1 <- my_dataset[my_dataset$RACEREC == "(01) Non-Hispanic White", ]
boot_results1 <- boot(data = my_group1, statistic = boot_mean, R = 1000)
# Plot bootstrapped sampling distribution
hist(boot_results1$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group2 <- my_dataset[my_dataset$RACEREC == "(02) Non-Hispanic Black", ]
boot_results2 <- boot(data = my_group2, statistic = boot_mean, R = 1000)
hist(boot_results2$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group3 <- my_dataset[my_dataset$RACEREC == "(03) Non-Hispanic American Indian/Alaska Native
", ]
boot_results3 <- boot(data = my_group2, statistic = boot_mean, R = 1000)
hist(boot_results3$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group4 <- my_dataset[my_dataset$RACEREC == "(04) Hispanic", ]
boot_results4 <- boot(data = my_group4, statistic = boot_mean, R = 1000)
hist(boot_results4$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group5 <- my_dataset[my_dataset$RACEREC == "(05) Non-Hispanic Asian or Pacific Islander", ]
boot_results5 <- boot(data = my_group5, statistic = boot_mean, R = 1000)
hist(boot_results5$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
# Check the independent variable
plot(density(my_dataset$RELIG_ENGAGEMENT, na.rm = TRUE, bw = 90),  lwd=2, main = "")
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
View(lab4data)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 2)  + theme_classic()
my_dataset$LONELY_log = log(my_dataset$LONELY)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 2)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 5)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 0)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 8)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = -2)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 2)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density()  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density()  + theme_classic()
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density()  + theme_classic()
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density()  + theme_classic()
# Bootstrap the mean for a g
ggplot(my_dataset, aes(x = LONELY)) + geom_density()  + theme_classic()
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density()  + theme_classic()
# Bootstrap the mean for a grou
# Check the independent variable
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density()  + theme_classic()
# Check the independent variable
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT)) + geom_density()  + theme_classic()
# Check the dependent variable
# Check skewness and kurtosis
skewness(my_dataset$LONELY)
kurtosis(my_dataset$LONELY)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density()  + theme_classic()
# Bootstrap the mean for a group to see the sampling distribution
boot_mean <- function(data, indices) {
d <- data[indices, ]  # Resample data with replacement
return(mean(d$LONELY))  # Calculate mean of the 'LONELY' variable
}
my_group1 <- my_dataset[my_dataset$RACEREC == "(01) Non-Hispanic White", ]
boot_results1 <- boot(data = my_group1, statistic = boot_mean, R = 1000)
# Plot bootstrapped sampling distribution
hist(boot_results1$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group2 <- my_dataset[my_dataset$RACEREC == "(02) Non-Hispanic Black", ]
boot_results2 <- boot(data = my_group2, statistic = boot_mean, R = 1000)
hist(boot_results2$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group3 <- my_dataset[my_dataset$RACEREC == "(03) Non-Hispanic American Indian/Alaska Native
", ]
boot_results3 <- boot(data = my_group2, statistic = boot_mean, R = 1000)
hist(boot_results3$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group4 <- my_dataset[my_dataset$RACEREC == "(04) Hispanic", ]
boot_results4 <- boot(data = my_group4, statistic = boot_mean, R = 1000)
hist(boot_results4$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
my_group5 <- my_dataset[my_dataset$RACEREC == "(05) Non-Hispanic Asian or Pacific Islander", ]
boot_results5 <- boot(data = my_group5, statistic = boot_mean, R = 1000)
hist(boot_results5$t, main = "Bootstrapped Sampling Distribution of Mean", xlab = "Mean Loneliness")
# Check the independent variable
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT)) + geom_density()  + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5)  + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Check the independent variable
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
# Check the dependent variable loneliness
# Check skewness and kurtosis
skewness(my_dataset$LONELY)
kurtosis(my_dataset$LONELY)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Check the independent variable religious engagement
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
# Check the dependent variable loneliness
# Check skewness and kurtosis
skewness(my_dataset$LONELY)
kurtosis(my_dataset$LONELY)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Check the independent variable religious engagement
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT)) + geom_density() + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
my_dataset$RELIG_ENGAGEMENT_log <- sqrt(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC)+ theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density()+ theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
my_dataset$RELIG_ENGAGEMENT_log <- sqrt(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
# Check the dependent variable loneliness
# Check skewness and kurtosis
skewness(my_dataset$LONELY)
kurtosis(my_dataset$LONELY)
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Check the independent variable religious engagement
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
my_dataset$LONELY_log <- sqrt(my_dataset$LONELY)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- sqrt(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
ks.test(my_dataset$LONELY, "pnorm", mean = mean(my_dataset$LONELY), sd = sd(my_dataset$LONELY))
# Check the dependent variable loneliness
# Check skewness and kurtosis
skewness(my_dataset$LONELY)
# Kolmogorov-Smirnov Test
ks.test(my_dataset$LONELY, "pnorm", mean = mean(my_dataset$LONELY), sd = sd(my_dataset$LONELY))
# Kolmogorov-Smirnov Test
ks.test(my_dataset$LONELY_log, "pnorm", mean = mean(my_dataset$LONELY), sd = sd(my_dataset$LONELY))
shapiro.test(my_dataset$LONELY)
# Kolmogorov-Smirnov Test
my_dataset %>%
group_by(RACEREC) %>%
summarize(W = shapiro.test(LONELY)$statistic, p_value = shapiro.test(LONELY)$p.value)
# Kolmogorov-Smirnov Test
my_dataset %>%
group_by(RACEREC) %>%
summarize(W = shapiro.test(LONELY_log)$statistic, p_value = shapiro.test(LONELY_log)$p.value)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- sqrt(my_dataset$LONELY)
skewness(my_dataset$LONELY_log)
kurtosis(my_dataset$LONELY_log)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = RELIG_ENGAGEMENT_log)) + geom_density() + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
my_dataset$RELIG_ENGAGEMENT_log <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- sqrt(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
# Check the dependent variable loneliness
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Check the independent variable religious engagement
# Skewness and kurtosis for religious engagement
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
my_dataset$RELIG_ENGAGEMENT_log <- sqrt(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_sqrt <- sqrt(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$LONELY_sqrt)
kurtosis(my_dataset$LONELY_sqrt)
skewness(my_dataset$RELIG_ENGAGEMENT_log)
kurtosis(my_dataset$RELIG_ENGAGEMENT_log)
my_dataset$LONELY_sqrt <- log(my_dataset$LONELY)
skewness(my_dataset$LONELY_sqrt)
skewness(my_dataset$LONELY_sqrt)
kurtosis(my_dataset$LONELY_sqrt)
my_dataset$LONELY_sqrt <- sqrt(my_dataset$LONELY)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
ggplot(my_dataset, aes(x = LONELY_sqrt)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_sqrt)
kurtosis(my_dataset$RELIG_ENGAGEMENT_sqrt)
my_dataset$RELIG_ENGAGEMENT_sqrt <- sqrt(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_sqrt)
kurtosis(my_dataset$RELIG_ENGAGEMENT_sqrt)
my_dataset$RELIG_ENGAGEMENT_sqrt <- log(my_dataset$RELIG_ENGAGEMENT)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
skewness(my_dataset$RELIG_ENGAGEMENT_sqrt)
kurtosis(my_dataset$RELIG_ENGAGEMENT_sqrt)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
library(interactions)
PROCESS(my_dataset, y = "LONELY", x = "RELIG_ENGAGEMENT", mods = c("RACERE"))
library(processR)
install.packages("processR")
library(processR)
library("processR")
library(process)
PROCESS(my_dataset, y = "LONELY", x = "RELIG_ENGAGEMENT", mods = c("RACEREC"))
library(bruceR)
PROCESS(my_dataset, y = "LONELY", x = "RELIG_ENGAGEMENT", mods = c("RACEREC"))
library(haven)
library(dplyr)
library(ggplot2)
library(tidyr)
library(car)
library(moments)
library(boot)
library(bruceR)
load("C:/Users/User/Downloads/ICPSR_38964-V2/ICPSR_38964/DS0001/38964-0001-Data.rda")
dataset <- da38964.0001
rm(da38964.0001)
#Select variables related to my research question
my_dataset <- dataset %>% select(RELIG_ATTEND, RELIG_IMP, RACEREC, LONELY_A, LONELY_B, LONELY_C)
my_dataset <- drop_na(my_dataset)
summary(my_dataset)
#recode and composite the variables
my_dataset$RELIG_ATTEND <- 5 - as.numeric(my_dataset$RELIG_ATTEND)
my_dataset$RELIG_IMP <- 5 - as.numeric(my_dataset$RELIG_IMP)
my_dataset$RELIG_ENGAGEMENT <- (my_dataset$RELIG_ATTEND + my_dataset$RELIG_IMP) / 2
my_dataset$LONELY_A <- as.numeric(my_dataset$LONELY_A)
my_dataset$LONELY_B <- as.numeric(my_dataset$LONELY_B)
my_dataset$LONELY_C <- as.numeric(my_dataset$LONELY_C)
my_dataset$LONELY <- (my_dataset$LONELY_A + my_dataset$LONELY_B + my_dataset$LONELY_C) / 3
# Check the dependent variable loneliness
# Density plot of loneliness
ggplot(my_dataset, aes(x = LONELY)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
# Check the independent variable religious engagement
# Skewness and kurtosis for religious engagement
skewness(my_dataset$RELIG_ENGAGEMENT)
kurtosis(my_dataset$RELIG_ENGAGEMENT)
leveneTest(LONELY ~ RACEREC, data = my_dataset)
my_dataset$LONELY_log <- log(my_dataset$LONELY)
ggplot(my_dataset, aes(x = LONELY_log)) + geom_density(adjust = 1.5) + facet_wrap(~RACEREC) + theme_classic()
PROCESS(my_dataset, y = "LONELY_log", x = "RELIG_ENGAGEMENT", mods = c("RACEREC"))
cor.test(data$RELIG_ENGAGEMENT, data$LONELY_log, method = "pearson")
cor.test(my_dataset$RELIG_ENGAGEMENT, my_dataset$LONELY_log, method = "pearson")
PROCESS(my_dataset, y = "LONELY_log", x = "RELIG_ENGAGEMENT", mods = c("RACEREC"))
corr(my_dataset)
Corr(my_dataset)
cor_data <- my_dataset %<% select(RELIG_ENGAGEMENT, LONELY_log, RACEREC)
cor_data <- my_dataset %>% select(RELIG_ENGAGEMENT, LONELY_log, RACEREC)
Corr(my_dataset)
Corr(cor_data)
cor_data <- my_dataset %>% select(RELIG_ENGAGEMENT, LONELY_log, RACEREC)
Corr(cor_data)
PROCESS(my_dataset, y = "LONELY_log", x = "RELIG_ENGAGEMENT", mods = c("RACEREC"))
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth() + theme_bruce() + facet_wrap(~RACEREC)
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth(method = "loess") + theme_bruce() + facet_wrap(~RACEREC)
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth(method = "lm") + theme_bruce() + facet_wrap(~RACEREC)
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth(method = "lm") + theme_bruce()
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth() + theme_bruce()
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth() + theme_bruce() + facet_wrap(~RACEREC)
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth() + theme_bruce()
ggplot(cor_data, aes(x = LONELY_log, y = RELIG_ENGAGEMENT)) + geom_point() + geom_smooth(method = "lm") + theme_bruce() + facet_wrap(~RACEREC)
